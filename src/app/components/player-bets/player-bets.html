<p-card class="players-panel h-full">
    <div class="players-header">
        <div class="header-mode-switch">
            <span [class.active]="view() === 'live'" (click)="setView('live')">Live Bets</span>
            <span class="divider">|</span>
            <span [class.active]="view() === 'top'" (click)="setView('top')">Top Winners</span>
        </div>
        @if (view() === 'live') {
        <div class="live-stats">
            <span>Players {{ bets().length }}</span>
            <span class="divider">â€¢</span>
            <span>Total {{ totalBetsAmount() | currency:'EUR':'symbol':'1.0-0' }}</span>
        </div>

        }
        @if (view() === 'top') {
        <div class="top-header-controls">
            <div class="mobile-top-tabs">
                <span [class.active]="activeTopBetTab() === 'profit'"
                    (click)="activeTopBetTab.set('profit')">Profit</span>
                <span class="divider">/</span>
                <span [class.active]="activeTopBetTab() === 'multiplier'"
                    (click)="activeTopBetTab.set('multiplier')">Multi</span>
            </div>
            <button class="refresh-btn" (click)="refreshTopBets()">
                <i class="pi pi-sync"></i>
            </button>
        </div>
        }
    </div>

    @if (view() === 'live') {

    <div class="players-list">
        @for (bet of bets(); track bet.username) {
        <div class="player-row" [class.cashed-out]="bet.multiplier">
            <div class="player-info">
                <div class="player-avatar">
                    <img [src]="getAvatarUrl(bet)" alt="Avatar" class="avatar-img" (error)="bet.avatarUrl = ''">
                </div>
                <span class="player-name">{{ bet.username }}</span>
            </div>
            <div class="player-stats">
                @if (bet.multiplier) {
                <span class="cashout-pill">
                    {{ bet.multiplier.toFixed(2) }}x
                </span>
                <span class="profit-amount">
                    +{{ bet.profit | currency:'EUR':'symbol':'1.0-2' }}
                </span>
                } @else {
                <span class="bet-amount">
                    {{ bet.amount | currency:'EUR':'symbol':'1.0-0' }}
                </span>
                }
            </div>
        </div>
        }
    </div>
    } @else {
    <app-top-bets [forceTab]="activeTopBetTab()"></app-top-bets>
    }

    <app-provably-fair-footer class="desktop-footer"></app-provably-fair-footer>
</p-card>