<p-dialog header="Provably Fair" [(visible)]="visible" [modal]="true" [style]="{ width: '400px' }"
    [breakpoints]="{'960px': '75vw', '640px': 'calc(100vw - 1rem)'}" [draggable]="false" [resizable]="false">
    <div class="fairness-content">
        <div class="info-block">
            <h3>Current Round Hash (SHA256)</h3>
            <p class="desc">Commitment generated before the round starts.</p>
            <div class="code-box">
                <code>{{ currentHash() || 'Waiting for round...' }}</code>
                <button pButton icon="pi pi-copy" class="p-button-text p-button-sm"
                    (click)="copyToClipboard(currentHash())" [disabled]="!currentHash()"></button>
            </div>
        </div>

        <div class="info-block">
            <h3>Previous Round Secret (Seed)</h3>
            <p class="desc">Revealed after crash. SHA256(Secret) must match the Hash.</p>
            <div class="code-box">
                <code>{{ lastSecret() || 'Revealed after crash' }}</code>
                <button pButton icon="pi pi-copy" class="p-button-text p-button-sm"
                    (click)="copyToClipboard(lastSecret())" [disabled]="!lastSecret()"></button>
            </div>
        </div>

        <div class="separator-line"></div>

        <div class="current-block verify-block">
            <h3>Verify Round</h3>
            <p class="desc">Paste the Secret (Seed) to verify the result independently.</p>

            <div class="input-group">
                <input type="text" pInputText [(ngModel)]="verifySecret" placeholder="Paste Secret here..."
                    class="verify-input" />
                <button pButton label="Verify" icon="pi pi-check" (click)="verify()"
                    [disabled]="!verifySecret"></button>
            </div>

            @if (verifyHash) {
            <div class="results-grid">
                <div class="result-item">
                    <label>Calculated Hash (SHA256)</label>
                    <code class="wrapper-code">{{ verifyHash }}</code>
                </div>
                <div class="result-item">
                    <label>Calculated Crash Output</label>
                    <strong class="highlight-result">{{ verifyResult ? verifyResult.toFixed(2) + 'x' : '-' }}</strong>
                </div>
            </div>
            }
        </div>

        <div class="verification-note">
            <i class="pi pi-shield"></i>
            <span>This game uses a reverse hash chain. Each round's hash is the seed for the next.</span>
        </div>
    </div>
</p-dialog>